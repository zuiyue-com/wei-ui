/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-10-19 19:31:27
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[299],{24025:function(t,e,a){a.d(e,{BB:function(){return o},BN:function(){return l},N7:function(){return k},NY:function(){return p},PM:function(){return h},Wx:function(){return u},Xq:function(){return f},Z0:function(){return m},iw:function(){return i},kA:function(){return d},l0:function(){return g},mE:function(){return w},wR:function(){return c},xS:function(){return b},yX:function(){return r},yo:function(){return y}});var s=a(52806),n=a(12688);function r(){return(0,s.Z)({url:"/wwwapi.php?to=sd&modac=tags",method:"get"})}function o(t){return(0,s.Z)({url:"/wwwapi.php?to=postSd",method:"get",params:t})}function i(t){const e={heat:{filter:"heat",orderby:"heats"},hot:{filter:"hot",orderby:""},digest:{filter:"digest",digest:"1"},lastpost:{filter:"lastpost",orderby:"lastpost"}},a={...e[t]};return a}function u(t){return(0,s.Z)({url:"/wwwapi.php?to=postSdTag",method:"get",params:t})}function l(t){return(0,s.Z)({url:"/wwwapi.php?to=postSdView&extra=",method:"get",params:t})}function c(t){return(0,s.Z)({url:"/wwwapi.php?to=postSdOfUser",method:"get",params:t})}async function p(t){const{body:{hash:e}}=await(0,n.Gv)();return(0,s.Z)({url:"/wwwapi.php?to=postReply",method:"post",data:{file:"",subject:"",usesig:"1",replysubmit:"yes",formhash:e,tid:t.tid,message:t.message}})}async function d(t){const{body:{hash:e}}=await(0,n.Gv)();return(0,s.Z)({url:"/wwwapi.php?to=postReply",method:"post",data:{subject:"",usesig:"1",replysubmit:"yes",formhash:e,...t}})}async function m(t){const{body:{hash:e}}=await(0,n.Gv)();return t.formhash=e,(0,s.Z)({url:"/wwwapi.php?to=postDel",method:"post",data:t})}async function g(t){const{body:{hash:e}}=await(0,n.Gv)();return(0,s.Z)({url:"/wwwapi.php?to=postFavAdd",method:"get",params:{id:t,formhash:e}})}async function f(t){const{body:{hash:e}}=await(0,n.Gv)();return(0,s.Z)({url:"/wwwapi.php?to=postFavDel",method:"post",data:{favid:t,formhash:e}})}function h(t){return(0,s.Z)({url:"/wwwapi.php?to=postFavlist",method:"get",params:t})}async function w(t){const{body:{hash:e}}=await(0,n.Gv)();return(0,s.Z)({url:"/wwwapi.php?to=postLikes",method:"get",params:{tid:t,hash:e}})}async function y(t){const{body:{hash:e}}=await(0,n.Gv)();return(0,s.Z)({url:"/wwwapi.php?to=postReport",method:"post",data:{referer:"",reportsubmit:"true",rtype:"post",url:"",inajax:"1",handlekey:`miscreport${t.rid}`,formhash:e,...t}})}async function b(t){const e={...t};e.tags=e.tags.join(",");const{body:{hash:a}}=await(0,n.Gv)();return(0,s.Z)({url:"/wwwapi.php?to=sd&modac=sharePrepare",method:"post",data:{formhash:a,...e}})}async function k(t){return(0,s.Z)({url:"/wwwapi.php?to=sdpost",method:"post",data:t})}},40645:function(t,e,a){a.d(e,{I:function(){return i},s:function(){return u}});var s=a(95244),n=a(92327),r=a(17052),o=a(47720);const i=t=>t.map((t=>{const e=t,a=t.imagelist.map((t=>(t.checked=!1,t)));e.imagelist=a;const s=t.imagelist.map((t=>t.bigimg));return e.images=s,e.collapse=[],e.expired_at=e.ms_deleteTime??"任务进行中",e.created_at=(0,n.p)(1e3*e.ms_createTime),e.ms_state=parseInt(e.ms_state)<=0?0:parseInt(e.ms_state),e.log=e.log?e.log:"",e})),u=(0,o.Q_)("imageResult",{state:()=>({tasks:[],queryForm:{page:1},pagination:{pageSize:1,total:1}}),getters:{getTasks(){return i(this.tasks)},getTasksImages(){return this.getTasks.map((t=>t.imagelist)).flat()},getTasksCheckedImages(){return this.getTasksImages.filter((t=>t.checked))},getProcessingTasks(){return this.getTasks.filter((t=>t.ms_state<100))},hasNoMoreData(){return(0,r.Gc)(this.queryForm.page,this.pagination.pageSize,this.pagination.total)}},actions:{async load(){return(0,s.ss)(this.queryForm).then((t=>{const{body:{list:e,page_perpage:a,page_allcount:s}}=t;return this.tasks=[...this.tasks,...e],this.pagination.pageSize=parseInt(a),this.pagination.total=parseInt(s),!0}))},async loadData(){return this.queryForm.page=1,this.load()},async loadMore(){return this.queryForm.page++,this.load()},resetImagesCheck(){this.getTasksCheckedImages.forEach((t=>t.checked=!1))}}})},92327:function(t,e,a){a.d(e,{E:function(){return i},p:function(){return u}});var s=a(27484),n=a.n(s),r=(a(33852),a(84110)),o=a.n(r);function i(t){return n().locale("zh-cn"),n()(t).fromNow()}function u(t,e="YYYY-MM-DD HH:mm:ss"){return n()(t).format(e)}n().extend(o())},17052:function(t,e,a){a.d(e,{D8:function(){return o},Gc:function(){return r},TD:function(){return s},Vj:function(){return n}});a(57658);function s(t,e){if(0===arguments.length)return null;const a=e||"{y}-{m}-{d} {h}:{i}:{s}";let s;"object"===typeof t?s=t:("string"===typeof t&&/^[0-9]+$/.test(t)&&(t=parseInt(t)),"number"===typeof t&&10===t.toString().length&&(t*=1e3),s=new Date(t));const n={y:s.getFullYear(),m:s.getMonth()+1,d:s.getDate(),h:s.getHours(),i:s.getMinutes(),s:s.getSeconds(),a:s.getDay()};return a.replace(/{([ymdhisa])+}/g,((t,e)=>{let a=n[e];return"a"===e?["日","一","二","三","四","五","六"][a]:(t.length>0&&a<10&&(a=`0${a}`),a||0)}))}function n(t=32){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";let a="";for(let s=0;s<t;s++)a+=e.charAt(Math.floor(Math.random()*e.length));return a}function r(t,e,a){const s=Math.ceil(a/e);return t>=s}function o(t=0){document.getElementById("app").scrollTo({top:t,left:0,behavior:"smooth"})}},29431:function(t,e,a){a.d(e,{Nb:function(){return r},jQ:function(){return s},jl:function(){return n}});const s={message:[{required:!0,message:"评论内容必填",trigger:"blur"},{min:10,message:"帖子长度必须大于10个字符",trigger:"blur"},{max:255,message:"帖子长度超过255个字符",trigger:"blur"}]},n={report_select:[{required:!0,message:"请选择举报类型",trigger:"blur"}],message:[{required:!0,message:"举报内容必填",trigger:"blur"},{min:8,max:255,message:"举报内容长度必须在8-255个字符",trigger:"blur"}]},r={images:[{required:!0,message:"发帖需要至少一张图片",trigger:"blur"}],subject:[{required:!0,message:"内容必填",trigger:"blur"}],tags:[{required:!0,message:"至少选择一个标签",trigger:"blur"}]}},70299:function(t,e,a){a.r(e),a.d(e,{default:function(){return U}});var s=a(4350),n=(a(3241),a(91103),a(73481)),r=(a(62029),a(20129)),o=(a(69840),a(15659)),i=(a(10444),a(57534)),u=(a(92471),a(57018)),l=(a(74367),a(6589),a(73632)),c=(a(74965),a(22040)),p=(a(99426),a(16273)),d=a(35756),m=(a(19414),a(57658),a(66252)),g=a(2262),f=a(3577),h=a(24025),w=a(40645),y=a(29431),b=a(22201),k=a(47720);const _={class:"share-form-container"},v={class:"lora-draw-card-body"},x={class:"lora-draw-image-group"},S={class:"lora-draw-image"};var j={__name:"shareform",setup(t,{expose:e}){const a=(0,b.tv)(),j=(0,m.f3)("$baseMessage"),Z=(0,w.s)(),{getTasksCheckedImages:D}=(0,k.Jk)(Z),I=(0,g.qj)({form:{images:[],subject:"",tags:[]},dialogFormVisible:!1,tagOptions:[],rules:{...y.Nb},formRef:null,postLoading:!1}),{dialogFormVisible:U,form:q,tagOptions:T,rules:C,formRef:F,postLoading:W}=(0,g.BK)(I);async function M(){const{body:t}=await(0,h.yX)();I.tagOptions=t.map((t=>({name:t,checked:!1})))}function V(t){const e=I.form.tags.findIndex((e=>e===t.name));e>=0||(t.checked=!0,I.form.tags.push(t.name))}async function G(t){const e=I.form.tags.findIndex((e=>e===t));if(e>=0){I.form.tags.splice(e,1);const a=I.tagOptions.find((e=>e.name===t));a&&(a.checked=!1)}}async function R(t){I.dialogFormVisible=!0,I.form.images=t}async function Y(){I["formRef"].validate((t=>{t&&N()}))}async function N(){I.postLoading=!0;const{body:{data:t}}=await(0,h.xS)(I.form),{body:{tid:e}}=await(0,h.N7)(t);I.postLoading=!1,j("发帖成功","success","vab-hey-message-success"),a.push(`/topic/${e}`)}return(0,m.bv)((()=>{M()})),e({showDialog:R}),(t,e)=>{const a=d.F8,h=p.Z,w=c.Dv,y=l.dq,b=r.nH,k=u.EZ,j=i.Ks,Z=o.ElButton,D=r.ly,I=n.d0,M=s.t;return(0,m.wg)(),(0,m.iD)("div",_,[(0,m.Wm)(I,{modelValue:(0,g.SU)(U),"onUpdate:modelValue":e[2]||(e[2]=t=>(0,g.dq)(U)?U.value=t:null),title:"分享作品"},{default:(0,m.w5)((()=>[(0,m.Wm)(D,{ref_key:"formRef",ref:F,model:(0,g.SU)(q),rules:(0,g.SU)(C),"label-width":"100px"},{default:(0,m.w5)((()=>[(0,m.Wm)(b,{prop:"images"},{default:(0,m.w5)((()=>[(0,m.Wm)(y,{gutter:16,span:"24",justify:"center"},{default:(0,m.w5)((()=>[((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)((0,g.SU)(q).images,(t=>((0,m.wg)(),(0,m.j4)(w,{key:t,lg:4,md:4,sm:4,xl:3,xs:12},{default:(0,m.w5)((()=>[(0,m.Wm)(h,{"body-style":{padding:"0px"},shadow:"hover"},{default:(0,m.w5)((()=>[(0,m._)("div",v,[(0,m._)("div",x,[(0,m._)("div",S,[(0,m.Wm)(a,{src:t},null,8,["src"])])])])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1}),(0,m.Wm)(b,{label:"标题",prop:"subject"},{default:(0,m.w5)((()=>[(0,m.Wm)(k,{modelValue:(0,g.SU)(q).subject,"onUpdate:modelValue":e[0]||(e[0]=t=>(0,g.SU)(q).subject=t),placeholder:"请发挥您的创意，大笔挥上贴近您作品的创意标题"},null,8,["modelValue"])])),_:1}),(0,m.Wm)(b,{label:"使用标签",prop:"tags"},{default:(0,m.w5)((()=>[((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)((0,g.SU)(q).tags,(t=>((0,m.wg)(),(0,m.j4)(j,{key:t,closable:"","disable-transitions":!1,style:{"margin-right":"10px","margin-bottom":"10px","margin-left":"0"},onClose:e=>G(t)},{default:(0,m.w5)((()=>[(0,m.Uk)((0,f.zw)(t),1)])),_:2},1032,["onClose"])))),128))])),_:1}),(0,m.Wm)(b,{label:"可选标签"},{default:(0,m.w5)((()=>[((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)((0,g.SU)(T),(t=>((0,m.wg)(),(0,m.j4)(j,{key:t.name,type:t.checked?"info":"","disable-transitions":!1,style:{"margin-right":"10px","margin-bottom":"10px","margin-left":"0"},class:(0,f.C_)({"cursor-pointer":!t.checked}),onClick:e=>V(t)},{default:(0,m.w5)((()=>[(0,m.Uk)((0,f.zw)(t.name),1)])),_:2},1032,["type","class","onClick"])))),128))])),_:1}),(0,m.Wm)(b,{label:""},{default:(0,m.w5)((()=>[(0,m.wy)(((0,m.wg)(),(0,m.j4)(Z,{type:"primary",onClick:Y},{default:(0,m.w5)((()=>[(0,m.Uk)(" 发布，欣赏下我的杰作吧 ")])),_:1})),[[M,(0,g.SU)(W)]]),(0,m.Wm)(Z,{onClick:e[1]||(e[1]=t=>U.value=!1)},{default:(0,m.w5)((()=>[(0,m.Uk)(" 先不分享，缓缓 ")])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}};function Z(t){t.__source="src/views/stablediffusion/components/shareform.vue"}var D=a(83744);"function"===typeof Z&&Z(j);const I=(0,D.Z)(j,[["__scopeId","data-v-2e326374"]]);var U=I}}]);