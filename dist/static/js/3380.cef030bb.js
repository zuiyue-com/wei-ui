/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-09-28 17:16:01
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[3380,6291],{17454:function(e,t,i){i.d(t,{m:function(){return r}});i(57658);var s=i(52806);function a(){return(0,s.Z)({url:"/wwwapi.php?to=sd&modac=formbase",method:"get"})}var n=i(15592),o=i(47720);const r=(0,o.Q_)("imageModel",{state:()=>({basicFormTemp:{sd_model_checkpoint_name:"",size:"Portrait",init_images:[]},basicForm:{taskType:"txt2img",override_settings:{sd_model_checkpoint:"",sd_vae:"animevae.pt"},styles:[],prompt_words:"",negative_prompt_words:"",init_images:[],width:128,height:1536,sampler_index:0,num_samples:20,cfg_scale:7,seed:-1,clip_skip:12,ensd:31337,batch_size:1},basicOptions:{Checkpoints:[],loraStyle:[],sdVae:{},imageSize:{},imageSizeCustom:{},samplerMethod:[],samplerStep:{},CFGScale:{},clipSkip:{}},fixForm:{model:1,times:0,range:0,zoom:"1x",width:512,height:768},fixModes:[],fixZooms:[],detailerForm:{model:1,loras:[],keyword:"",re_keyword:"",level:.5,mask:4,noise:.25,only_mask:!0},detailerModels:[]}),getters:{isCustomImageSize(e){return"Custom"===e.basicFormTemp.size},hasUploadedImage(e){return e.basicFormTemp.init_images.length>0},checkedLoraStyles(){return this.basicOptions.loraStyle.filter((e=>e.checked))},checkedLoraStylesLength(){return this.checkedLoraStyles.length}},actions:{async load(){const{body:{Checkpoints:e,loraStyle:t,sdVae:i,imageSize:s,samplerMethod:n,samplerStep:o,CFGScale:r,clipSkip:c}}=await a(),l=Object.entries(e).map((e=>{const[t,i]=e;return i.key=t,i})),m=Object.entries(t).map((e=>{const[t,i]=e;i.key=t,i.checked=!1;const[s,a,n]=i.weight;return i.weight={min:s,max:a,value:n},i})),{basicForm:d}=this;d.num_samples=o[2]??1,d.cfg_scale=r[2]??1,d.clip_skip=c[2]??1,this.setSdModel(l[0]??{});const u={Checkpoints:l,loraStyle:m,sdVae:i,imageSize:s,samplerMethod:n,samplerStep:{min:o[0]??1,max:o[1]??60},CFGScale:{min:r[0]??1,max:r[1]??30},clipSkip:{min:c[0]??1,max:c[1]??12}};this.basicOptions=u,this.setCustomImageSizeParams(s)},setCustomImageSizeParams(e){const t=e["Custom"];this.basicOptions.imageSizeCustom={minWidth:t[0],maxWidth:t[1],minHeight:t[2],maxHeight:t[3],defaultWidth:t[4],defaultHeight:t[5]},this.changeImageSize()},changeImageSize(){const{basicFormTemp:e,basicForm:t,basicOptions:i,isCustomImageSize:s}=this;if(s)t.width=i.imageSizeCustom.defaultWidth,t.height=i.imageSizeCustom.defaultHeight;else{const s=i.imageSize[e.size];t.width=s[0],t.height=s[1]}},resetLoraStyleSelectStatus(){this.checkedLoraStyles.filter((e=>e.checked=!1))},setUploadImage(e){this.basicForm.init_images=e},setSdModel(e){this.basicFormTemp.sd_model_checkpoint_name=e.name,this.basicForm.override_settings.sd_model_checkpoint=e.key},addLoraStyle(e){const t=this.basicForm.styles.findIndex((t=>t.key===e.key));return!(t>=0)&&(this.basicForm.styles.push({pic:e.pic,name:e.name,key:e.key,weight:e.weight.value,min:e.weight.min,max:e.weight.max}),!0)},removeLoraStyle(e){const t=this.basicForm.styles.findIndex((t=>t.key===e));return t>=0&&(this.basicForm.styles.splice(t,1),!0)},getUploadImages(){return this.basicForm.init_images.map((async e=>{const{width:t,height:i,src:s}=await(0,n.I)(e.raw);let a="";return t&&(a=`图片大小 ${t}x${i}`),e.extra=a,e.url=s,e}))},createImage(){const e={...this.basicForm};e.styles=e.styles.map((e=>{const t={name:e.key,weight:e.weight};return t})),e.init_images=e.init_images.map((e=>{const t=e.url;return t})),console.log(JSON.stringify(this.basicForm)),console.log(JSON.stringify(e))}}})},15592:function(e,t,i){function s(e){return new Promise(((t,i)=>{const s=new FileReader;s.readAsDataURL(e),s.onload=function(){if(2==s.readyState){const e=new Image;e.src=s.result,e.onload=function(){const e={width:this.width,height:this.height,src:this.src};t(e)}}else i()}}))}function a(e){return e.replace(/data:.+?;base64,/,"")}i.d(t,{I:function(){return s},x:function(){return a}})},76291:function(e,t,i){i.r(t),i.d(t,{default:function(){return p}});var s=i(66252);const a={class:"el-card el-upload-dragger list-item"},n={class:"list-item-meta"},o={class:"list-item-meta-avatar"},r={class:"list-item-meta-content"},c={class:"card-header"};function l(e,t){return(0,s.wg)(),(0,s.iD)("div",a,[(0,s._)("div",n,[(0,s._)("div",o,[(0,s.WI)(e.$slots,"image",{},void 0,!0)]),(0,s._)("div",r,[(0,s._)("div",c,[(0,s.WI)(e.$slots,"header",{},void 0,!0)]),(0,s.WI)(e.$slots,"content",{},void 0,!0)])])])}function m(e){e.__source="src/components/CardItem/index.vue"}var d=i(83744);const u={};"function"===typeof m&&m(u);const h=(0,d.Z)(u,[["render",l],["__scopeId","data-v-aaf33c88"]]);var p=h},73380:function(e,t,i){i.r(t),i.d(t,{default:function(){return w}});var s=i(61046),a=(i(3241),i(19414),i(79329)),n=(i(68984),i(66252)),o=i(2262),r=i(49963),c=i(3577),l=i(17454),m=i(76291),d=i(15592),u=i(47720);const h=(0,n._)("div",{class:"el-upload__text"},[(0,n.Uk)(" 把图片拖放到这里 / "),(0,n._)("em",null,"点击这里上传")],-1),p={key:0,class:"width-100"};var g={__name:"upload",setup(e){const t=(0,l.m)(),{basicFormTemp:i,basicForm:g,hasUploadedImage:_}=(0,u.Jk)(t),{setUploadImage:f}=t,w=(0,o.iH)(null);function S(){w.value.clearFiles()}return(0,n.YP)(_,(async()=>{const e=await Promise.all(i.value.init_images.map((async e=>{const{width:t,height:i,src:s}=await(0,d.I)(e.raw);let a="";return t&&(a=`图片大小 ${t}x${i}`),{url:s,title:a}})));f(e)})),(e,t)=>{const l=a.LW,d=s.F8,u=(0,n.up)("vab-icon");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.wy)((0,n.Wm)(l,{ref_key:"uploadRef",ref:w,"file-list":(0,o.SU)(i).init_images,"onUpdate:fileList":t[0]||(t[0]=e=>(0,o.SU)(i).init_images=e),drag:"",limit:1,"auto-upload":!1,"show-file-list":!1,class:"upload-demo"},{default:(0,n.w5)((()=>[h])),_:1},8,["file-list"]),[[r.F8,!(0,o.SU)(_)]]),(0,o.SU)(_)?((0,n.wg)(),(0,n.iD)("div",p,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,o.SU)(g).init_images,(e=>((0,n.wg)(),(0,n.j4)((0,o.SU)(m["default"]),{key:e},{image:(0,n.w5)((()=>[(0,n.Wm)(d,{src:e.url,width:"48",class:"upload-image"},null,8,["src"])])),header:(0,n.w5)((()=>[(0,n._)("span",null,(0,c.zw)(e.title),1),(0,n.Wm)(u,{icon:"delete-bin-6-line",style:{color:"var(--el-color-danger)"},onClick:S})])),_:2},1024)))),128))])):(0,n.kq)("",!0)],64)}}};function _(e){e.__source="src/views/stablediffusion/components/upload.vue"}"function"===typeof _&&_(g);const f=g;var w=f}}]);