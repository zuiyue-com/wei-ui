/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-10-12 09:18:53
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[8545,7280,2369,8594],{95244:function(e,t,a){a.d(t,{Ix:function(){return n},R1:function(){return s},_5:function(){return l},ss:function(){return r}});var i=a(52806);function s(){return(0,i.Z)({url:"/wwwapi.php?to=sd&modac=formbase",method:"get"})}function n(e,t){const a=new FormData;return a.append("Filedata",e.file),(0,i.Z)({url:"/wwwapi.php?to=sd&modac=upload",method:"post",headers:{"Content-Type":"multipart/form-data"},data:a,...t})}function r(e){return(0,i.Z)({url:"/wwwapi.php?to=sd&modac=myworks",method:"get",params:e})}function l(e){return(0,i.Z)({url:"/wwwapi.php?to=sd&modac=cancle",method:"post",data:{misId:e}})}},91222:function(e,t,a){a.d(t,{m:function(){return d}});var i=a(95244),s=a(15592),n=a(96486),r=a.n(n),l=a(47720);const d=(0,l.Q_)("imageModel",{state:()=>({formType:"basic",basicFormTemp:{sd_model_checkpoint_name:"",size:"Portrait"},basicForm:{taskType:"txt2img",override_settings:{sd_model_checkpoint:"",sd_vae:""},styles:[],prompt_words:"",negative_prompt_words:"",init_images:[],width:128,height:1536,sampler_index:"",num_samples:0,cfg_scale:0,seed:-1,clip_skip:0,ensd:31337,batch_size:1},basicOptions:{Checkpoints:[],loraStyle:[],sdVae:{},imageSize:{},imageSizeCustom:{},samplerMethod:[],samplerStep:{},CFGScale:{},clipSkip:{}},hdrepaireForm:{taskType:"HD",base_image:{},hr_upscaler:"",hr_scale:"2",hr_resize_x:0,hr_resize_y:0,hr_second_pass_steps:0,denoising_strength:0},hdrepaireOptions:{hrImageSize:{},imageSizeCustom:{},hrUpscaler:{},hrSecondPassSteps:{}},adetailerForm:{taskType:"AD",base_image:{},ad_model:"",styles:[],ad_prompt_words:"",ad_negative_prompt_words:"",ad_confidence:0,ad_dilate_erode:0,ad_denoising_strength:0,ad_inpaint_only_masked:1},adetailerOptions:{adModel:{},loraStyle:[],adConfidence:{},adMaskBlur:{},adDenoisingStrength:{}}}),getters:{isCustomImageSize(e){return"Custom"===e.basicFormTemp.size},isHdrepaireCustomImageSize(e){return"custom"===e.hdrepaireForm.hr_scale},hasUploadedImage(e){return e.basicForm.init_images.length>0}},actions:{setFormType(e){this.formType=e},formatLoraStyle(e){return Object.entries(e).map((e=>{const[t,a]=e,i=r().cloneDeep(a);i.key=t,i.checked=!1;const[s,n,l]=i.weight;return i.weight={min:s,max:n,value:l},i}))},initBasic({Checkpoints:e,loraStyle:t,sdVae:a,imageSize:i,samplerMethod:s,samplerStep:n,CFGScale:r,clipSkip:l}){const d=Object.entries(e).map((e=>{const[t,a]=e;return a.key=t,a})),o=this.formatLoraStyle(t),m={Checkpoints:d,loraStyle:o,sdVae:a,imageSize:i,imageSizeCustom:{...this.getCustomImageSizeParams(i)},samplerMethod:s,samplerStep:{min:n[0]??1,max:n[1]??60},CFGScale:{min:r[0]??1,max:r[1]??30},clipSkip:{min:l[0]??1,max:l[1]??12}};this.basicOptions=m;const u=m.imageSize[this.basicFormTemp.size];this.setSdModel(d[0]??{}),this.basicForm.override_settings.sd_vae=a["default"],this.basicForm.width=u[0],this.basicForm.height=u[1],this.basicForm.sampler_index=s[0]??"",this.basicForm.num_samples=n[2]??1,this.basicForm.cfg_scale=r[2]??1,this.basicForm.clip_skip=l[2]??1},initHdrepaire({hrImageSize:e,hrUpscaler:t,hrSecondPassSteps:a,denoisingStrength:i}){const s={hrImageSize:e,hrUpscaler:t,hrSecondPassSteps:{min:a[0],max:a[1]},denoisingStrength:{min:i[0],max:i[1]},imageSizeCustom:{...this.getCustomImageSizeParams(e)}};this.hdrepaireOptions=s;const n=s.hrImageSize[this.hdrepaireForm.hr_scale];this.hdrepaireForm.hr_resize_x=n[0],this.hdrepaireForm.hr_resize_y=n[1],this.hdrepaireForm.hr_upscaler=t["default"],this.hdrepaireForm.hr_second_pass_steps=a[2],this.hdrepaireForm.denoising_strength=i[2]},initAdetailer({adModel:e,loraStyle:t,adConfidence:a,adMaskBlur:i,adDenoisingStrength:s}){const n=this.formatLoraStyle(t),r={adModel:e,loraStyle:n,adConfidence:{min:a[0],max:a[1]},adMaskBlur:{min:i[0],max:i[1]},adDenoisingStrength:{min:s[0],max:s[1]}};this.adetailerOptions=r,this.adetailerForm.ad_model=e["0"],this.adetailerForm.ad_confidence=a[2],this.adetailerForm.ad_dilate_erode=i[2],this.adetailerForm.ad_denoising_strength=s[2]},async load(){const{body:e}=await(0,i.R1)();this.initBasic(e),this.initHdrepaire(e),this.initAdetailer(e)},getCustomImageSizeParams(e){const t=e["Custom"]?e["Custom"]:e["custom"];return{minWidth:t[0],maxWidth:t[1],minHeight:t[2],maxHeight:t[3],defaultWidth:t[4],defaultHeight:t[5]}},setUploadImage(e){const t=e.map((e=>({picid:e.picid,url:e.bigimg,title:e.title})));this.basicForm.init_images=t},setSdModel(e){this.basicFormTemp.sd_model_checkpoint_name=e.name,this.basicForm.override_settings.sd_model_checkpoint=e.key},getUploadImages(){return this.basicForm.init_images.map((async e=>{const{width:t,height:a,src:i}=await(0,s.I)(e.raw);let n="";return t&&(n=`图片大小 ${t}x${a}`),e.extra=n,e.url=i,e}))},hdSetUploadImage(e){const t={picid:e.picid,url:e.bigimg,title:e.title};this.hdrepaireForm.base_image=t},adSetUploadImage(e){const t={picid:e.picid,url:e.bigimg,title:e.title};this.adetailerForm.base_image=t},createImage(){let e={};switch(this.formType){case"hdrepaire":e={...this.hdrepaireForm},e.base_image.url&&(e.base_image=e.base_image.url);break;case"adetailer":e={...this.adetailerForm},e.base_image.url&&(e.base_image=e.base_image.url);break;case"basic":default:e={...this.basicForm},e.styles=e.styles.map((e=>{const t={name:e.key,weight:e.weight};return t})),e.init_images=e.init_images.map((e=>{const t=e.url;return t})),e.init_images.length>0&&(e.taskType="img2img");break}console.log(e)}}})},15592:function(e,t,a){function i(e){return new Promise(((t,a)=>{const i=new FileReader;i.readAsDataURL(e),i.onload=function(){if(2==i.readyState){const e=new Image;e.src=i.result,e.onload=function(){const e={width:this.width,height:this.height,src:this.src};t(e)}}else a()}}))}function s(e){return e.replace(/data:.+?;base64,/,"")}a.d(t,{I:function(){return i},x:function(){return s}})},97280:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var i=a(66252);const s={class:"el-card el-upload-dragger list-item"},n={class:"list-item-meta"},r={class:"list-item-meta-avatar"},l={class:"list-item-meta-content"},d={class:"card-header"},o={class:"list-item-meta-action"};function m(e,t){return(0,i.wg)(),(0,i.iD)("div",s,[(0,i._)("div",n,[(0,i._)("div",r,[(0,i.WI)(e.$slots,"image",{},void 0,!0)]),(0,i._)("div",l,[(0,i._)("div",d,[(0,i.WI)(e.$slots,"header",{},void 0,!0)]),(0,i.WI)(e.$slots,"content",{},void 0,!0)]),(0,i._)("div",o,[(0,i.WI)(e.$slots,"action",{},void 0,!0)])])])}function u(e){e.__source="src/components/CardItem/index.vue"}var c=a(83744);const p={};"function"===typeof u&&u(p);const h=(0,c.Z)(p,[["render",m],["__scopeId","data-v-4186fb5a"]]);var g=h},92369:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var i=a(57018),s=(a(3241),a(74367),a(66252)),n=a(2262),r=a(3577),l=a(25498),d={__name:"index",props:{modelValue:{type:[Number,String],default:0},placeholder:{type:String,default:""},min:{type:Number,default:0},max:{type:Number,default:0},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,d=(0,n.iH)(parseInt(a.modelValue));function o(){const e=parseInt(d.value);isNaN(e)?d.value=defaultVal:(d.value<a.min&&(d.value=a.min),d.value>a.max&&(d.value=a.max),t("update:modelValue",d.value))}(0,s.YP)((()=>a.modelValue),(()=>{d.value=parseInt(a.modelValue)}));const m=(0,s.Fl)((()=>""===d.value||(0,l.yH)(d.value)));return(t,a)=>{const l=i.EZ;return(0,s.wg)(),(0,s.j4)(l,{modelValue:(0,n.SU)(d),"onUpdate:modelValue":a[0]||(a[0]=e=>(0,n.dq)(d)?d.value=e:null),modelModifiers:{number:!0},placeholder:e.placeholder,class:(0,r.C_)({"error-value":!(0,n.SU)(m)}),disabled:e.disabled,onChange:o},(0,s.Nv)({_:2},[t.$slots.prepend?{name:"prepend",fn:(0,s.w5)((()=>[(0,s.WI)(t.$slots,"prepend")])),key:"0"}:void 0]),1032,["modelValue","placeholder","class","disabled"])}}};function o(e){e.__source="src/components/InputNumber/index.vue"}var m=a(83744);"function"===typeof o&&o(d);const u=(0,m.Z)(d,[["__scopeId","data-v-2685ef0d"]]);var c=u},58545:function(e,t,a){a.r(t),a.d(t,{default:function(){return U}});var i=a(47223),s=(a(3241),a(96624),a(14132)),n=(a(50986),a(61715),a(20129)),r=(a(69840),a(6589),a(61046)),l=(a(19414),a(66252)),d=a(2262),o=a(3577),m=a(97280),u=a(18594),c=a(91222),p=a(47720);const h=e=>((0,l.dD)("data-v-78424496"),e=e(),(0,l.Cn)(),e),g={class:"HDRepaireFrom"},_={key:1,class:"el-card el-upload-dragger list-item"},f=h((()=>(0,l._)("div",{class:"list-item-meta"},[(0,l._)("div",{class:"list-item-meta-content-left"},[(0,l._)("ul",null,[(0,l._)("li",null,"请从任务列表选择想要操作的图片"),(0,l._)("li",null,"点击图片上的 (高清修复) 按钮")])])],-1))),S=[f],b={class:"txt2imgFrom"};var w={__name:"hdrepaire",setup(e){const t=(0,c.m)(),{hdrepaireForm:a,hdrepaireOptions:h,isHdrepaireCustomImageSize:f}=(0,p.Jk)(t),{hdSetUploadImage:w}=t;return(e,t)=>{const c=r.F8,p=(0,l.up)("vab-icon"),v=n.nH,y=n.ly,z=s.BT,U=s.ElSelect,k=i.BM;return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",g,[(0,l.Wm)(y,{"label-position":"top","label-width":"100px"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{label:"基础图片"},{default:(0,l.w5)((()=>[(0,d.SU)(a).base_image.url?((0,l.wg)(),(0,l.j4)((0,d.SU)(m["default"]),{key:0},{image:(0,l.w5)((()=>[(0,l.Wm)(c,{src:(0,d.SU)(a).base_image.url,width:"48"},null,8,["src"])])),header:(0,l.w5)((()=>[(0,l._)("span",null,(0,o.zw)((0,d.SU)(a).base_image.title),1)])),action:(0,l.w5)((()=>[(0,l.Wm)(p,{icon:"delete-bin-6-line",class:"cursor-pointer",style:{color:"var(--el-color-danger)"},onClick:t[0]||(t[0]=e=>(0,d.SU)(w)({}))})])),_:1})):((0,l.wg)(),(0,l.iD)("div",_,S))])),_:1})])),_:1})]),(0,l._)("div",b,[(0,l.Wm)(y,{"label-position":"top","label-width":"100px"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{label:"放大倍数"},{default:(0,l.w5)((()=>[(0,l.Wm)((0,d.SU)(u["default"]),{size:(0,d.SU)(a).hr_scale,"onUpdate:size":t[1]||(t[1]=e=>(0,d.SU)(a).hr_scale=e),width:(0,d.SU)(a).hr_resize_x,"onUpdate:width":t[2]||(t[2]=e=>(0,d.SU)(a).hr_resize_x=e),height:(0,d.SU)(a).hr_resize_y,"onUpdate:height":t[3]||(t[3]=e=>(0,d.SU)(a).hr_resize_y=e),"image-size":(0,d.SU)(h).hrImageSize,"image-size-custom":(0,d.SU)(h).imageSizeCustom,disabled:!(0,d.SU)(f)},null,8,["size","width","height","image-size","image-size-custom","disabled"])])),_:1}),(0,l.Wm)(v,{label:"修复方式"},{default:(0,l.w5)((()=>[(0,l.Wm)(U,{modelValue:(0,d.SU)(a).hr_upscaler,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,d.SU)(a).hr_upscaler=e),clearable:""},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,d.SU)(h).hrUpscaler,(e=>((0,l.wg)(),(0,l.j4)(z,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(v,{label:"高清采样次数"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{modelValue:(0,d.SU)(a).hr_second_pass_steps,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,d.SU)(a).hr_second_pass_steps=e),min:(0,d.SU)(h).hrSecondPassSteps.min,max:(0,d.SU)(h).hrSecondPassSteps.max},null,8,["modelValue","min","max"])])),_:1}),(0,l.Wm)(v,{label:"重绘幅度"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{modelValue:(0,d.SU)(a).denoising_strength,"onUpdate:modelValue":t[6]||(t[6]=e=>(0,d.SU)(a).denoising_strength=e),min:(0,d.SU)(h).denoisingStrength.min,max:(0,d.SU)(h).denoisingStrength.max,step:.1},null,8,["modelValue","min","max"])])),_:1})])),_:1})])],64)}}};function v(e){e.__source="src/views/stablediffusion/components/hdrepaire.vue"}var y=a(83744);"function"===typeof v&&v(w);const z=(0,y.Z)(w,[["__scopeId","data-v-78424496"]]);var U=z},18594:function(e,t,a){a.r(t),a.d(t,{default:function(){return _}});var i=a(73632),s=(a(3241),a(74965),a(22040)),n=(a(99426),a(87692)),r=(a(45393),a(22411),a(66252)),l=a(2262),d=a(3577),o=a(92369);const m={key:0},u={key:1},c={class:"widthAndHeightInput"};var p={__name:"image_size",props:{imageSize:{type:Object,default:()=>{}},size:{type:String,default:""},width:{type:Number,default:0},height:{type:Number,default:0},imageSizeCustom:{type:Object,default:()=>{}},disabled:{type:Boolean,default:!1}},emits:["update:size","update:width","update:height"],setup(e,{emit:t}){const a=e,p=(0,l.iH)(a.size);async function h(e){t("update:width",e)}async function g(e){t("update:height",e)}function _(){const e=p.value;if("custom"===e.toLowerCase())t("update:width",a.imageSizeCustom.defaultWidth),t("update:height",a.imageSizeCustom.defaultHeight);else{const i=a.imageSize[e];t("update:width",i[0]),t("update:height",i[1])}t("update:size",e)}return(t,a)=>{const f=n.dn,S=n.KD,b=s.Dv,w=i.dq;return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("div",null,[(0,r.Wm)(S,{modelValue:(0,l.SU)(p),"onUpdate:modelValue":a[0]||(a[0]=e=>(0,l.dq)(p)?p.value=e:null),size:"large",onChange:_},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.imageSize,((e,t)=>((0,r.wg)(),(0,r.j4)(f,{key:t,label:t},{default:(0,r.w5)((()=>[2===e.length?((0,r.wg)(),(0,r.iD)("div",m,(0,d.zw)(`${e[0]} * ${e[1]}`),1)):(0,r.kq)("",!0),e.length>2?((0,r.wg)(),(0,r.iD)("div",u,"自定义")):(0,r.kq)("",!0)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])]),(0,r._)("div",c,[(0,r.Wm)(w,null,{default:(0,r.w5)((()=>[(0,r.Wm)(b,{span:12},{default:(0,r.w5)((()=>[(0,r.Wm)((0,l.SU)(o["default"]),{value:e.width,placeholder:"请输入生图的宽度",min:e.imageSizeCustom.minWidth,max:e.imageSizeCustom.maxWidth,disabled:e.disabled,"onUpdate:modelValue":h},{prepend:(0,r.w5)((()=>[(0,r.Uk)("宽度")])),_:1},8,["value","min","max","disabled"])])),_:1}),(0,r.Wm)(b,{span:12},{default:(0,r.w5)((()=>[(0,r.Wm)((0,l.SU)(o["default"]),{value:e.height,placeholder:"请输入生图的高度",min:e.imageSizeCustom.minHeight,max:e.imageSizeCustom.maxHeight,disabled:e.disabled,"onUpdate:modelValue":g},{prepend:(0,r.w5)((()=>[(0,r.Uk)("高度")])),_:1},8,["value","min","max","disabled"])])),_:1})])),_:1})])],64)}}};function h(e){e.__source="src/views/stablediffusion/components/image_size.vue"}"function"===typeof h&&h(p);const g=p;var _=g}}]);