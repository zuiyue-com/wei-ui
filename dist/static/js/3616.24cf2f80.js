/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-10-16 10:23:30
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[3616,529],{95244:function(e,t,i){i.d(t,{Ix:function(){return r},R1:function(){return s},_5:function(){return n},ss:function(){return o}});var a=i(52806);function s(){return(0,a.Z)({url:"/wwwapi.php?to=sd&modac=formbase",method:"get"})}function r(e,t){const i=new FormData;return i.append("Filedata",e.file),(0,a.Z)({url:"/wwwapi.php?to=sd&modac=upload",method:"post",headers:{"Content-Type":"multipart/form-data"},data:i,...t})}function o(e){return(0,a.Z)({url:"/wwwapi.php?to=sd&modac=myworks",method:"get",params:e})}function n(e){return(0,a.Z)({url:"/wwwapi.php?to=sd&modac=cancle",method:"post",data:{misId:e}})}},91222:function(e,t,i){i.d(t,{m:function(){return d}});var a=i(95244),s=i(15592),r=i(96486),o=i.n(r),n=i(47720);const d=(0,n.Q_)("imageModel",{state:()=>({formType:"basic",basicFormTemp:{sd_model_checkpoint_name:"",size:"Portrait"},basicForm:{taskType:"txt2img",override_settings:{sd_model_checkpoint:"",sd_vae:""},styles:[],prompt_words:"",negative_prompt_words:"",init_images:[],width:128,height:1536,sampler_index:"",num_samples:0,cfg_scale:0,seed:-1,clip_skip:0,ensd:31337,batch_size:1},basicOptions:{Checkpoints:[],loraStyle:[],sdVae:{},imageSize:{},imageSizeCustom:{},samplerMethod:[],samplerStep:{},CFGScale:{},clipSkip:{}},hdrepaireForm:{taskType:"HD",base_image:{},hr_upscaler:"",hr_scale:"2",hr_resize_x:0,hr_resize_y:0,hr_second_pass_steps:0,denoising_strength:0},hdrepaireOptions:{hrImageSize:{},imageSizeCustom:{},hrUpscaler:{},hrSecondPassSteps:{}},adetailerForm:{taskType:"AD",base_image:{},ad_model:"",styles:[],ad_prompt_words:"",ad_negative_prompt_words:"",ad_confidence:0,ad_dilate_erode:0,ad_denoising_strength:0,ad_inpaint_only_masked:1},adetailerOptions:{adModel:{},loraStyle:[],adConfidence:{},adMaskBlur:{},adDenoisingStrength:{}}}),getters:{isCustomImageSize(e){return"Custom"===e.basicFormTemp.size},isHdrepaireCustomImageSize(e){return"custom"===e.hdrepaireForm.hr_scale},hasUploadedImage(e){return e.basicForm.init_images.length>0}},actions:{setFormType(e){this.formType=e},formatLoraStyle(e){return Object.entries(e).map((e=>{const[t,i]=e,a=o().cloneDeep(i);a.key=t,a.checked=!1;const[s,r,n]=a.weight;return a.weight={min:s,max:r,value:n},a}))},initBasic({Checkpoints:e,loraStyle:t,sdVae:i,imageSize:a,samplerMethod:s,samplerStep:r,CFGScale:o,clipSkip:n}){const d=Object.entries(e).map((e=>{const[t,i]=e;return i.key=t,i})),m=this.formatLoraStyle(t),l={Checkpoints:d,loraStyle:m,sdVae:i,imageSize:a,imageSizeCustom:{...this.getCustomImageSizeParams(a)},samplerMethod:s,samplerStep:{min:r[0]??1,max:r[1]??60},CFGScale:{min:o[0]??1,max:o[1]??30},clipSkip:{min:n[0]??1,max:n[1]??12}};this.basicOptions=l;const c=l.imageSize[this.basicFormTemp.size];this.setSdModel(d[0]??{}),this.basicForm.override_settings.sd_vae=i["default"],this.basicForm.width=c[0],this.basicForm.height=c[1],this.basicForm.sampler_index=s[0]??"",this.basicForm.num_samples=r[2]??1,this.basicForm.cfg_scale=o[2]??1,this.basicForm.clip_skip=n[2]??1},initHdrepaire({hrImageSize:e,hrUpscaler:t,hrSecondPassSteps:i,denoisingStrength:a}){const s={hrImageSize:e,hrUpscaler:t,hrSecondPassSteps:{min:i[0],max:i[1]},denoisingStrength:{min:a[0],max:a[1]},imageSizeCustom:{...this.getCustomImageSizeParams(e)}};this.hdrepaireOptions=s;const r=s.hrImageSize[this.hdrepaireForm.hr_scale];this.hdrepaireForm.hr_resize_x=r[0],this.hdrepaireForm.hr_resize_y=r[1],this.hdrepaireForm.hr_upscaler=t["default"],this.hdrepaireForm.hr_second_pass_steps=i[2],this.hdrepaireForm.denoising_strength=a[2]},initAdetailer({adModel:e,loraStyle:t,adConfidence:i,adMaskBlur:a,adDenoisingStrength:s}){const r=this.formatLoraStyle(t),o={adModel:e,loraStyle:r,adConfidence:{min:i[0],max:i[1]},adMaskBlur:{min:a[0],max:a[1]},adDenoisingStrength:{min:s[0],max:s[1]}};this.adetailerOptions=o,this.adetailerForm.ad_model=e["0"],this.adetailerForm.ad_confidence=i[2],this.adetailerForm.ad_dilate_erode=a[2],this.adetailerForm.ad_denoising_strength=s[2]},async load(){const{body:e}=await(0,a.R1)();this.initBasic(e),this.initHdrepaire(e),this.initAdetailer(e)},getCustomImageSizeParams(e){const t=e["Custom"]?e["Custom"]:e["custom"];return{minWidth:t[0],maxWidth:t[1],minHeight:t[2],maxHeight:t[3],defaultWidth:t[4],defaultHeight:t[5]}},setUploadImage(e){const t=e.map((e=>({picid:e.picid,url:e.bigimg,title:e.title})));this.basicForm.init_images=t},setSdModel(e){this.basicFormTemp.sd_model_checkpoint_name=e.name,this.basicForm.override_settings.sd_model_checkpoint=e.key},getUploadImages(){return this.basicForm.init_images.map((async e=>{const{width:t,height:i,src:a}=await(0,s.I)(e.raw);let r="";return t&&(r=`图片大小 ${t}x${i}`),e.extra=r,e.url=a,e}))},hdSetUploadImage(e){const t={picid:e.picid,url:e.bigimg,title:e.title};this.hdrepaireForm.base_image=t},adSetUploadImage(e){const t={picid:e.picid,url:e.bigimg,title:e.title};this.adetailerForm.base_image=t},createImage(){let e={};switch(this.formType){case"hdrepaire":e={...this.hdrepaireForm},e.base_image.url&&(e.base_image=e.base_image.url);break;case"adetailer":e={...this.adetailerForm},e.base_image.url&&(e.base_image=e.base_image.url);break;case"basic":default:e={...this.basicForm},e.styles=e.styles.map((e=>{const t={name:e.key,weight:e.weight};return t})),e.init_images=e.init_images.map((e=>{const t=e.url;return t})),e.init_images.length>0&&(e.taskType="img2img");break}console.log(e)}}})},15592:function(e,t,i){function a(e){return new Promise(((t,i)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=function(){if(2==a.readyState){const e=new Image;e.src=a.result,e.onload=function(){const e={width:this.width,height:this.height,src:this.src};t(e)}}else i()}}))}function s(e){return e.replace(/data:.+?;base64,/,"")}i.d(t,{I:function(){return a},x:function(){return s}})},16273:function(e,t,i){i.d(t,{Z:function(){return p}});var a=i(30032),s=(i(3241),i(91154),i(97830)),r=(i(13768),i(66252)),o=i(2262),n=i(3577),d=i(22201),m=(0,r.aZ)({__name:"index",props:{header:{type:String,default:""},bodyStyle:{type:Object,default:()=>({})},shadow:{type:String,default:""},skeleton:{type:Boolean,default:!1},skeletonRows:{type:Number,default:4}},setup(e){let t=null;const i=(0,o.iH)(!0);return t=setTimeout((()=>{i.value=!1}),500),(0,d.iS)(((e,i,a)=>{clearInterval(t),a()})),(t,d)=>{const m=s.vk,l=a.Kf;return(0,r.wg)(),(0,r.j4)(l,{"body-style":e.bodyStyle,class:"vab-card",shadow:e.shadow},(0,r.Nv)({default:(0,r.w5)((()=>[e.skeleton?((0,r.wg)(),(0,r.j4)(m,{key:0,animated:"",loading:(0,o.SU)(i),rows:e.skeletonRows},{default:(0,r.w5)((()=>[(0,r.WI)(t.$slots,"default",{class:"vab-card-transition"})])),_:3},8,["loading","rows"])):(0,r.WI)(t.$slots,"default",{key:1,class:"vab-card-transition"})])),_:2},[t.$slots.header||e.header?{name:"header",fn:(0,r.w5)((()=>[(0,r.WI)(t.$slots,"header",{},(()=>[(0,r.Uk)((0,n.zw)(e.header),1)]))])),key:"0"}:void 0]),1032,["body-style","shadow"])}}});function l(e){e.__source="library/components/VabCard/index.vue"}var c=i(83744);"function"===typeof l&&l(m);const h=(0,c.Z)(m,[["__scopeId","data-v-391150ea"]]);var p=h}}]);