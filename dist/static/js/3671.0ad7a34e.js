/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2023-10-19 19:31:27
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[3671],{24025:function(t,e,a){a.d(e,{BB:function(){return i},BN:function(){return d},N7:function(){return b},NY:function(){return c},PM:function(){return f},Wx:function(){return u},Xq:function(){return g},Z0:function(){return l},iw:function(){return r},kA:function(){return p},l0:function(){return m},mE:function(){return w},wR:function(){return h},xS:function(){return v},yX:function(){return o},yo:function(){return y}});var n=a(52806),s=a(12688);function o(){return(0,n.Z)({url:"/wwwapi.php?to=sd&modac=tags",method:"get"})}function i(t){return(0,n.Z)({url:"/wwwapi.php?to=postSd",method:"get",params:t})}function r(t){const e={heat:{filter:"heat",orderby:"heats"},hot:{filter:"hot",orderby:""},digest:{filter:"digest",digest:"1"},lastpost:{filter:"lastpost",orderby:"lastpost"}},a={...e[t]};return a}function u(t){return(0,n.Z)({url:"/wwwapi.php?to=postSdTag",method:"get",params:t})}function d(t){return(0,n.Z)({url:"/wwwapi.php?to=postSdView&extra=",method:"get",params:t})}function h(t){return(0,n.Z)({url:"/wwwapi.php?to=postSdOfUser",method:"get",params:t})}async function c(t){const{body:{hash:e}}=await(0,s.Gv)();return(0,n.Z)({url:"/wwwapi.php?to=postReply",method:"post",data:{file:"",subject:"",usesig:"1",replysubmit:"yes",formhash:e,tid:t.tid,message:t.message}})}async function p(t){const{body:{hash:e}}=await(0,s.Gv)();return(0,n.Z)({url:"/wwwapi.php?to=postReply",method:"post",data:{subject:"",usesig:"1",replysubmit:"yes",formhash:e,...t}})}async function l(t){const{body:{hash:e}}=await(0,s.Gv)();return t.formhash=e,(0,n.Z)({url:"/wwwapi.php?to=postDel",method:"post",data:t})}async function m(t){const{body:{hash:e}}=await(0,s.Gv)();return(0,n.Z)({url:"/wwwapi.php?to=postFavAdd",method:"get",params:{id:t,formhash:e}})}async function g(t){const{body:{hash:e}}=await(0,s.Gv)();return(0,n.Z)({url:"/wwwapi.php?to=postFavDel",method:"post",data:{favid:t,formhash:e}})}function f(t){return(0,n.Z)({url:"/wwwapi.php?to=postFavlist",method:"get",params:t})}async function w(t){const{body:{hash:e}}=await(0,s.Gv)();return(0,n.Z)({url:"/wwwapi.php?to=postLikes",method:"get",params:{tid:t,hash:e}})}async function y(t){const{body:{hash:e}}=await(0,s.Gv)();return(0,n.Z)({url:"/wwwapi.php?to=postReport",method:"post",data:{referer:"",reportsubmit:"true",rtype:"post",url:"",inajax:"1",handlekey:`miscreport${t.rid}`,formhash:e,...t}})}async function v(t){const e={...t};e.tags=e.tags.join(",");const{body:{hash:a}}=await(0,s.Gv)();return(0,n.Z)({url:"/wwwapi.php?to=sd&modac=sharePrepare",method:"post",data:{formhash:a,...e}})}async function b(t){return(0,n.Z)({url:"/wwwapi.php?to=sdpost",method:"post",data:t})}},5649:function(t,e,a){a.d(e,{o:function(){return d}});a(57658);var n=a(24025),s=a(81095),o=a(30582),i=a(17052),r=a(47720);const u=(0,o.L)(),d=(0,r.Q_)("topic",{state:()=>({queryForm:{tid:0,page:1},detail:{},images:[],comments:[],extraInfo:{},pagination:{pageSize:1,total:1},favId:0,likeId:0,imageId:0}),getters:{canAction(){return u.canAction(this.detail.authorid)},getTopicUserId(){return this.detail.authorid},getTopicTags(){return this.detail.tags?this.detail.tags.map((t=>({id:t[0],name:t[1]}))):[]},getTopicImages(){return this.images},getTopicImagesMaxHeight(){const t=this.getTopicImages.map((t=>t.height));return Math.max(...t)},getTid(){return this.detail.tid},getPid(){return this.detail.pid},hasNoMoreData(){return(0,i.Gc)(this.queryForm.page,this.pagination.pageSize,this.pagination.total-1)}},actions:{formatImages(){return this.detail.attachments?Object.values(this.detail.attachments).map((t=>({id:t.aid,image:`${t.url}${t.attachment}`,height:t.height}))):[]},setTopic(t){this.queryForm.tid=t},async loadTopic(){const{body:{list:t,forum_thread:e,page_perpage:a,page_allcount:s}}=await(0,n.BN)(this.queryForm),o=t;this.detail=o[0]??{},this.images=this.formatImages(),this.comments=o.slice(1),this.extraInfo=e,this.pagination.pageSize=parseInt(a),this.pagination.total=parseInt(s),this.favId=this.detail.threadHasFavorite?.favid??0,this.likeId=this.detail.threadHasRecommend?.tid??0,this.imageId=this.images[0]?this.images[0].id:0},async loadAddedTopic(){const{body:{list:t,forum_thread:e,page_perpage:a,page_allcount:s}}=await(0,n.BN)(this.queryForm);this.comments=[t[1],...this.comments],this.extraInfo=e,this.pagination.pageSize=parseInt(a),this.pagination.total=parseInt(s)},async loadMoreComments(){if(this.hasNoMoreData)return;this.queryForm.page++;const{body:{list:t}}=await(0,n.BN)(this.queryForm);this.comments.push(...t)},async handleAddFavTopic(){const{body:{favid:t}}=await(0,n.l0)(this.getTid);t>0?(this.favId=t,this.extraInfo.favtimes++,s.gp.$baseMessage("收藏成功","success","vab-hey-message-success")):s.gp.$baseMessage("收藏失败","error","vab-hey-message-error")},async handleDelFavTopic(){await(0,n.Xq)(this.favId),this.favId=0,this.extraInfo.favtimes--,s.gp.$baseMessage("取消收藏成功","success","vab-hey-message-success")},async handleAddLikeTopic(){if(!this.canAction)return;const{body:{recommendv:t}}=await(0,n.mE)(this.getTid);this.likeId=t,this.extraInfo.recommend_add++}}})},17052:function(t,e,a){a.d(e,{D8:function(){return i},Gc:function(){return o},TD:function(){return n},Vj:function(){return s}});a(57658);function n(t,e){if(0===arguments.length)return null;const a=e||"{y}-{m}-{d} {h}:{i}:{s}";let n;"object"===typeof t?n=t:("string"===typeof t&&/^[0-9]+$/.test(t)&&(t=parseInt(t)),"number"===typeof t&&10===t.toString().length&&(t*=1e3),n=new Date(t));const s={y:n.getFullYear(),m:n.getMonth()+1,d:n.getDate(),h:n.getHours(),i:n.getMinutes(),s:n.getSeconds(),a:n.getDay()};return a.replace(/{([ymdhisa])+}/g,((t,e)=>{let a=s[e];return"a"===e?["日","一","二","三","四","五","六"][a]:(t.length>0&&a<10&&(a=`0${a}`),a||0)}))}function s(t=32){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";let a="";for(let n=0;n<t;n++)a+=e.charAt(Math.floor(Math.random()*e.length));return a}function o(t,e,a){const n=Math.ceil(a/e);return t>=n}function i(t=0){document.getElementById("app").scrollTo({top:t,left:0,behavior:"smooth"})}},16273:function(t,e,a){a.d(e,{Z:function(){return l}});var n=a(30032),s=(a(3241),a(91154),a(97830)),o=(a(13768),a(66252)),i=a(2262),r=a(3577),u=a(22201),d=(0,o.aZ)({__name:"index",props:{header:{type:String,default:""},bodyStyle:{type:Object,default:()=>({})},shadow:{type:String,default:""},skeleton:{type:Boolean,default:!1},skeletonRows:{type:Number,default:4}},setup(t){let e=null;const a=(0,i.iH)(!0);return e=setTimeout((()=>{a.value=!1}),500),(0,u.iS)(((t,a,n)=>{clearInterval(e),n()})),(e,u)=>{const d=s.vk,h=n.Kf;return(0,o.wg)(),(0,o.j4)(h,{"body-style":t.bodyStyle,class:"vab-card",shadow:t.shadow},(0,o.Nv)({default:(0,o.w5)((()=>[t.skeleton?((0,o.wg)(),(0,o.j4)(d,{key:0,animated:"",loading:(0,i.SU)(a),rows:t.skeletonRows},{default:(0,o.w5)((()=>[(0,o.WI)(e.$slots,"default",{class:"vab-card-transition"})])),_:3},8,["loading","rows"])):(0,o.WI)(e.$slots,"default",{key:1,class:"vab-card-transition"})])),_:2},[e.$slots.header||t.header?{name:"header",fn:(0,o.w5)((()=>[(0,o.WI)(e.$slots,"header",{},(()=>[(0,o.Uk)((0,r.zw)(t.header),1)]))])),key:"0"}:void 0]),1032,["body-style","shadow"])}}});function h(t){t.__source="library/components/VabCard/index.vue"}var c=a(83744);"function"===typeof h&&h(d);const p=(0,c.Z)(d,[["__scopeId","data-v-391150ea"]]);var l=p},53671:function(t,e,a){a.r(e),a.d(e,{default:function(){return g}});var n=a(16273),s=a(25917),o=(a(3241),a(27109),a(61684),a(66252)),i=a(2262),r=a(5649),u=a(47720);const d={class:"image-box"},h=["src"];var c={__name:"images",setup(t){const e=(0,r.o)(),{imageId:a,getTopicImages:c,getTopicImagesMaxHeight:p}=(0,u.Jk)(e),l=(0,o.Fl)((()=>c.value.length<=1?"never":"always"));async function m(t,e){a.value=c.value[t].id}return(t,e)=>{const a=s.B6,r=s.$J,u=n.Z;return(0,o.wg)(),(0,o.j4)(u,{shadow:"hover"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{height:(0,i.SU)(p)+"px",autoplay:!1,arrow:(0,i.SU)(l),onChange:m},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,i.SU)(c),(t=>((0,o.wg)(),(0,o.j4)(a,{key:t.id},{default:(0,o.w5)((()=>[(0,o._)("div",d,[(0,o._)("img",{src:t.image},null,8,h)])])),_:2},1024)))),128))])),_:1},8,["height","arrow"])])),_:1})}}};function p(t){t.__source="src/views/topic/components/images.vue"}var l=a(83744);"function"===typeof p&&p(c);const m=(0,l.Z)(c,[["__scopeId","data-v-22acaf4c"]]);var g=m}}]);